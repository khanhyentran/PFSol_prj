From a3ee91c5eb84e4d778ffc2f1bb794e5c9cd4f7fb Mon Sep 17 00:00:00 2001
From: Nghia Tran <nghia.tran.hx@rvc.renesas.com>
Date: Tue, 6 Nov 2018 18:28:12 +0700
Subject: [PATCH 2/2] dt binding for usb ehci on rza2m

---
 arch/arm/boot/dts/r7s9210-rza2mevb.dts | 19 ++++++++++++++++++-
 arch/arm/boot/dts/r7s9210.dtsi         | 23 +++++++++++++++++++++++
 2 files changed, 41 insertions(+), 1 deletion(-)

diff --git a/arch/arm/boot/dts/r7s9210-rza2mevb.dts b/arch/arm/boot/dts/r7s9210-rza2mevb.dts
index bc47bf1..187741e 100644
--- a/arch/arm/boot/dts/r7s9210-rza2mevb.dts
+++ b/arch/arm/boot/dts/r7s9210-rza2mevb.dts
@@ -200,7 +200,13 @@
 	irq3_pins: irq3 {
 		pinmux = <RZA2_PINMUX(P5, 7, 2)>;	/* IRQ3 */
 	};
-	
+
+	/* USB Channel 1*/
+	usb1_pins: usb1 {
+		pinmux = <RZA2_PINMUX(PC, 0, 1)>, /* VBUSIN1 */
+			 <RZA2_PINMUX(PC, 5, 1)>, /* VBUSEN1 */
+			 <RZA2_PINMUX(P7, 5, 5)>; /* OVRCUR1 */
+	};
 
 };
 
@@ -461,3 +467,14 @@
 		reg = <0>;
 	};
 };
+
+&usb2_phy1 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&usb1_pins>;
+	status = "okay";
+};
+
+&ehci1 {
+
+	status = "okay";
+};
diff --git a/arch/arm/boot/dts/r7s9210.dtsi b/arch/arm/boot/dts/r7s9210.dtsi
index f7024ef..69a00a9 100644
--- a/arch/arm/boot/dts/r7s9210.dtsi
+++ b/arch/arm/boot/dts/r7s9210.dtsi
@@ -560,4 +560,27 @@
 	};
 */
 
+	usb2_phy1: usb-phy@e821a200 {
+		compatible = "renesas,usb2-phy-r7s9210";
+		reg = <0xe821a200 0x700>;
+		interrupts = <GIC_SPI 36 IRQ_TYPE_LEVEL_HIGH>;
+		clocks = <&cpg CPG_MOD 60>;
+		power-domains = <&cpg>;
+		#phy-cells = <0>;
+		reset = <&cpg 60>;
+		status = "disabled";
+	};
+
+	ehci1: usbhcd@e821a100 {
+		compatible = "generic-ehci";
+		reg = <0xe821a100 0x100>;
+		interrupts = <GIC_SPI 36 IRQ_TYPE_LEVEL_HIGH>;
+		clocks = <&cpg CPG_MOD 60>;
+		phys = <&usb2_phy1>;
+		phy-names = "usb1";
+		power-domains = <&cpg>;
+		reset = <&cpg 60>;
+		status = "disabled";
+	};
+
 };
-- 
1.9.1

